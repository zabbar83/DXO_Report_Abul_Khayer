select  
        r1.wing_id wingId,
        r1.wing_name wingName,
        NVL(r1.teritory, 0) teritoryCount,
        NVL(r1.route, 0) routeCount,
        NVL(r1.adxo, 0) adxoCount,
        NVL(r1.totalActivityCon, 0) totalActivityCon,
        NVL(r1.bddfCon, 0) bddfCon,
        NVL(r1.bdfcCon, 0) bdfcCon,
        NVL(r1.bdadCon, 0) bdadCon,
        NVL(r1.bdTotalCon, 0) bdTotalCon,     
        NVL(r1.msbCon, 0) msbCon,
        NVL(r1.msbgCon, 0) msbgCon,
        NVL(r1.fmCon, 0) fmCon,
        NVL(r1.sigCon, 0) sigCon,
        NVL(r1.styCon, 0) styCon,
        NVL(r1.supremeTotalCon, 0) supremeTotalCon,
        NVL(r1.bddfOut, 0) bddfOut,
        NVL(r1.bdfcOut, 0) bdfcOut,
        NVL(r1.bdadOut, 0) bdadOut,
        NVL(r1.bdTotalOut, 0) bdTotalOut,
        NVL(r1.msbOut, 0) msbOut,
        NVL(r1.msgOut, 0) msgOut,
        NVL(r1.supFmaOut, 0) supFmaOut,
        NVL(r1.supSigOut, 0) supSigOut,
        NVL(r1.supStyOut, 0) supStyOut,
        NVL(r1.supTotalOut, 0) supTotalOut,
        NVL(r1.avonOut, 0) avonOut,
        NVL(r1.avonStock, 0) avonStock,
        NVL(r1.avonServeyOut, 0) avonServeyOut,
        
        NVL(aris.aris_outlet,0) arisOutlet,
        NVL(aris.slimCigCon, 0) slimCigCon,
        NVL(aris.aris_stock_outlet,0) aristStockOutlet,
        NVL(aris.onSlimSelling, 0) onSlimSelling,
        NVL(aris.onSurveyOutlet, 0) onSurveyOutlet
from
(select    
        v.wing_id,
        v.wing_name,
        bd.teritory,
        bd.route,
        bd.adxo,
        bd.totalConsumer totalActivityCon,
        bd.bddfCon,
        bd.bdfcCon,
        bd.bdadCon,
        bd.bdTotalCon,     
        bd.msbCon,
        bd.msbgCon,       
        bd.fmCon,
        bd.sigCon,
        bd.styCon,
        bd.supremeTotalCon,
        bd.avonOut,
        bd.avonStock,
        bd.avonServeyOut,
        bd.bddfOut,
        bd.bdfcOut,
        bd.bdadOut,
        bd.bdTotalOut,
        bd.msbOut,
        bd.msgOut,
        bd.supFmaOut,
        bd.supSigOut,
        bd.supStyOut,
        bd.supTotalOut
from (select distinct wing_id,wing_name from v_teritory_all v where 1=1 and (:wingId is null or v.wing_id = :wingId)) v
Left    Join
(select  
        vta.wing_id wingId,
        vta.wing_name wingName,
        count(distinct vta.teritory_id) teritory,
        count(distinct vta.route_id) route,
        count(distinct qa.br_user_id) adxo,
        count(distinct c.id) totalConsumer,
        count(distinct case when qmp.id=1 then qa.consumer_id else null end) bddfOut,
        count(distinct case when qmp.id=2 then qa.consumer_id else null end) bdfcOut,
        count(distinct case when qmp.id=94 then qa.consumer_id else null end) bdadOut,
        count(distinct case when qmp.id in (1,2,94) then qa.consumer_id else null end) bdTotalOut,
        
        count(distinct case when qmp.id=3 then qa.consumer_id else null end) msbOut,
        count(distinct case when qmp.id=95 then qa.consumer_id else null end) msgOut,
        
        count(distinct case when qmp.id=98 then qa.consumer_id else null end) supFmaOut,
        count(distinct case when qmp.id=99 then qa.consumer_id else null end) supSigOut,
        count(distinct case when qmp.id=100 then qa.consumer_id else null end) supStyOut,
        count(distinct case when qmp.id in (98,99) then qa.consumer_id else null end) supTotalOut,
        
        count(distinct case when qmp.id=103 then qa.consumer_id else null end) avonOut,
        count(distinct case when qmp.id=103 and pr.product_stock > 0 then qa.consumer_id else null end) avonStock,
        round(case when count(distinct case when qmp.id=103 then qa.consumer_id else null end) > 0 then count(distinct case when qmp.id=103 and pr.product_stock > 0 then qa.consumer_id else null end) / count(distinct case when qmp.id=103 then qa.consumer_id else null end) * 100 else 0 end) avonServeyOut,
        
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=1 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) bddfCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=2 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) bdfcCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=94 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) bdadCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id in (1,2,94) then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) bdTotalCon,
        
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=3 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) msbCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=95 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) msbgCon,
        
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=98 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) fmCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=99 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) sigCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id=100 then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) styCon,
        round(case when count(distinct c.id) > 0 then count(distinct case when qmp.id in (98,99) then qa.consumer_id else null end) / count(distinct c.id) * 100 else 0 end) supremeTotalCon
from    (select * from v_teritory_all v where 1=1 and (:wingId is null or v.wing_id = :wingId)) vta
join    consumer_teritory ct on vta.route_id = ct.teritory_id
join    consumer c on ct.consumer_id = c.id and status=1
        join (select * from question_answers where target_date = :targetDate) qa on c.id = qa.consumer_id
left    join product_record pr on qa.consumer_id = pr.consumer_id
left    join ques_market_product qmp on pr.QUES_MARKET_PRODUCT_ID=qmp.id
group   by vta.wing_id,vta.wing_name
) bd
On  v.wing_id=bd.wingId
)r1
Full Join
(select  v.wing_id,
        v.wing_name,
        abd.aris_outlet,
        abd.slimCigCon,
        abd.aris_stock_outlet,
        abd.onSlimSelling,
        onSurveyOutlet
from (select distinct wing_id,wing_name from v_teritory_all v where 1=1 and (:wingId is null or v.wing_id = :wingId)) v
Left    Join
(
select  
        v.wing_id wingId,v.wing_name wingName,
        count(distinct case when qmp.id in (96,97) then pr.consumer_id else null end)aris_outlet,
        count(distinct case when qmp.id in (96,97) then qa.consumer_id else null end) slimCigCon,
        count(distinct case when qmp.id in (96,97) and pr.product_stock > 0 then pr.consumer_id else null end) aris_stock_outlet,
        round(case when count(distinct case when qmp.id in (96,97) then qa.consumer_id else null end) > 0 then (count(distinct case when qmp.id in (96,97) and pr.product_stock > 0 then pr.consumer_id else null end) * 100) /count(distinct case when qmp.id in (96,97) then qa.consumer_id else null end) else 0 end) onSlimSelling,
        round(case when count(distinct case when qmp.id in (96,97) then pr.consumer_id else null end) > 0 then (count(distinct case when qmp.id in (96,97) and pr.product_stock > 0 then pr.consumer_id else null end) * 100) /count(distinct case when qmp.id in (96,97) then pr.consumer_id else null end) else 0 end) onSurveyOutlet
from    (select * from v_teritory_all v where 1=1 and (:wingId is null or v.wing_id = :wingId)) v
join    consumer_teritory ct on ct.teritory_id=v.route_id
join    consumer c on ct.consumer_id=c.id and c.status=1
join    product_record pr on c.id=pr.consumer_id
and     pr.target_date= :targetDate
join    ques_market_product qmp on pr.QUES_MARKET_PRODUCT_ID=qmp.id
left    join (select  distinct qao.id slim_cig_ans_id,q.consumer_id
            from    question_answers q
            join    product_record pr on q.consumer_id=pr.consumer_id
            and     pr.target_date= :targetDate
            join    question_opts_map qom on q.QUESTION_OPTION_MAP_ID=qom.id and q.question_id=12
            join    ques_activity_opts qao on qom.question_options_id=qao.id and qao.id=28
        )qa on pr.consumer_id=qa.consumer_id
left    join own_market_product_map ompm on qmp.id=ompm.market_product_id
left    join territory_products tp on ompm.own_product_id=tp.product_id
group   by v.wing_id,v.wing_name
)abd
on v.wing_id=abd.wingId
)aris
on r1.wing_id=aris.wing_id
order by r1.wing_id